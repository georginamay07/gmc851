{% extends 'mysite/base.html' %}

{% block body %}

<div id="myCarousel" class="carousel slide" data-ride="carousel">

    <!-- Wrapper for slides -->
    <div class="carousel-inner" role="listbox">

      <div class="item active">
        <img style="width:100%;height:80%;object-fit:cover;" src="https://barber.org.uk/wp-content/uploads/2020/12/nk-message.jpg" >
        <div class="carousel-caption">
          <h3>Donate</h3>
          <p>The Barber welcomes monetary donations – no matter how large or small. </p>
        </div>
      </div>

      <div class="item">
        <img style="width:100%;height:80%;object-fit:cover;"src="https://artticketsassets.s3.amazonaws.com/barber/ba-talk.jpg">
        <div class="carousel-caption">
          <h3>Support</h3>
          <p>Your support will help fund exciting and worthwhile Barber projects.</p>
        </div>
      </div>
    
      <div class="item">
        <img style="width:100%;height:80%;object-fit:cover;"src="https://media.timeout.com/images/102044109/image.jpg">
        <div class="carousel-caption">
          <h3>Thank you</h3>
          <p>If you wish to make a substantial donation, please contact the Barber’s Communications and Marketing Manager, Andrew Davies.</p>
        </div>
      </div>
      <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
      </a>
      <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
      </a>
    </div>
    <p class="donate_text"> Every donation is featured on Barber Tiles. After choosing your donation amount, you can upload a picture of your favourite piece of artwork. 
        These will then be used to create a virtual tile where your name and image will be features for other users to see! </p>
    </div>
</div>

<div class="donate_div">
    <h2 class="donate_title">Make a donation</h2>
    <form method="POST">
      {% csrf_token %}
        <div class="donate_options" style="margin-left:60px;">
            <input id="amount1" type="radio" value="1" name="amount" class="money_button"> £1.00</input><br>
            <input id="amount2" type="radio" value="5" name="amount" class="money_button"> £5.00</input><br>
            <input id="amount3" type="radio" value="10" name="amount" class="money_button"> £10.00</input><br>
        </div>
        <div class="donate_image"
            <label for="img">Upload image:</label>
            <input style="padding-left:40%;" type="file" id="img" name="img" accept="image/*">
        </div>

        <script src="https://www.paypal.com/sdk/js?client-id=AYdRfbvZj6Qunsj9uWNirrIeqRuGvxxa3x0DS1HmhD0xTFpXnhckGRqZ-vqJDEc4sD_6HYmCYSYv38Av&currency=GBP"></script>

    <!-- Set up a container element for the button -->
    <div id="paypal-button-container"></div>

    <script>
      paypal.Buttons({

        // Sets up the transaction when a payment button is clicked
        createOrder: function(data, actions) {
          if(document.getElementById('amount1').checked){
            amount=document.getElementById('amount1').value
          }
          else if(document.getElementById('amount2').checked){
            amount=document.getElementById('amount2').value
          }
          else if(document.getElementById('amount3').checked){
            amount=document.getElementById('amount3').value
          }
          return actions.order.create({
            purchase_units: [{
              amount: {
                value: amount

              }
              
            }]
          });
        },

        // Finalize the transaction after payer approval
        onApprove: function(data, actions) {
          return actions.order.capture().then(function(orderData) {
            // Successful capture! For dev/demo purposes:
                console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));
                var transaction = orderData.purchase_units[0].payments.captures[0];
                window.location.href='http://127.0.0.1:8000/donate_success/';

          });
        }
      }).render('#paypal-button-container');

    </script>
  </body>
</html>
</div>

{% endblock body %}


